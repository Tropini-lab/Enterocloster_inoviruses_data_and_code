---
title: "Untitled"
author: "Juan"
date: "13/01/2022"
output: html_document
---

load the libraries
```{r}
library(tidyverse)
library(ComplexHeatmap)
library(readxl)
library(circlize)
```


Load the data from the ANI analysis
```{r}
dat <- read_excel("ANIb_percentage_identity.xlsx")
dat

# write the names for the strains
names <- c("C. hathewayi","C. citroniae", 
           "C. bolteae ATCC BAA613", 
           "C. clostridioforme 538", 
           "C. clostridioforme 455",
           "C. bolteae WAL 7855", 
           "C. aldenense AM40 2AC")

```


Make the complex heatmap matrix
```{r}
dat_matrix <- as.matrix(dat[-1])
rownames(dat_matrix) <- names
colnames(dat_matrix) <- names

dat_matrix
```

Make the ANI heatmap using ComplexHeatmap
```{r}

f1 = colorRamp2(seq(min(dat_matrix), max(dat_matrix), length = 3), c("#EEEEEE", "lightsteelblue1", "dodgerblue3"))

Heatmap(dat_matrix, 
        col = f1,
        name = "% Identity",
        column_title = "Average Nucleotide Identity", 
        rect_gp = gpar(col = "grey80"),
        row_dend_side = "right",
        #border = T,
        cluster_rows = T,
        row_names_side = "left",
        row_names_gp = gpar(fontsize = 12, fontface = "italic"), # controls the font size of row names
        column_names_gp = gpar(fontsize = 12, fontface = "italic"),
        column_names_rot = 45,
        row_names_max_width = max_text_width(rownames(dat_matrix),gp = gpar(fontsize = 16)),
        column_names_max_height = max_text_width(rownames(dat_matrix)),
        
        
        cell_fun = function(j, i, x, y, width, height, fill) {
        grid.text(sprintf("%.2f", dat_matrix[i, j]), x, y, gp = gpar(fontsize = 14))}
        )


```


